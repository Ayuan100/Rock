!function e(t,o,r){function n(s,c){if(!o[s]){if(!t[s]){var l="function"==typeof require&&require;if(!c&&l)return l(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){var o=t[s][1][e];return n(o||e)},u,u.exports,e,t,o,r)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e("./scanner"),n=e("./watcher"),i=e("./renderer"),s=function(){function e(){this.prefix="rock-",this.viewModelPool={}}return e.prototype.registerViewModel=function(e,t){console.log("register view model: ",e),this.viewModelPool[e]?this.viewModelPool[e].push(t):this.viewModelPool[e]=new Array(t),console.log("Current viewModelPool:",this.viewModelPool)},e.prototype.init=function(e){console.log("init Rock---------------"),e&&(this.prefix=e+"-"),this.scanner=new r.Scanner(this),this.watcher=new n.Watcher(this,this.viewModelPool),this.mapList=this.scanner.scan(),console.log("maplist:",this.mapList),this.renderer=new i.Renderer(this,this.mapList),this.watcher.observe(this.render),this.render(),console.log("finish init Rock------------")},e.prototype.getViewModel=function(e){return this.viewModelPool[e][0]},e.prototype.render=function(){this.renderer.renderAll()},e}();o.Rock=s},{"./renderer":3,"./scanner":4,"./watcher":6}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=function(){return function(e,t){this.element=e,this.mappingList=[],t&&(this.mappingList=t)}}();o.Map=r;var n=function(){return function(e,t,o){this.viewmodel=t,this.rock_attr=e,this.vm_attr=o}}();o.Mapping=n},{}],3:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){this.rock=e,this.mapList=t,console.log("new renderer")}return e.prototype.renderAll=function(){if(console.log("render all"),this.mapList)for(var e=0;e<this.mapList.length;e++)this.render(this.mapList[e])},e.prototype.render=function(e){for(var t=e.mappingList,o=e.element,r=0;r<t.length;r++){var n=t[r],i=n.viewmodel;switch(console.log("render- ",n.rock_attr,"in ",n),n.rock_attr){case"text":o.innerHTML=i[n.vm_attr];break;case"x":o.style.left=i[n.vm_attr]+"px";break;case"y":o.style.top=i[n.vm_attr]+"px";break;case"color":o.style.color=i[n.vm_attr];break;case"onmousemove":o.onmousemove=i[n.vm_attr];break;case"onmousedown":o.onmousedown=i[n.vm_attr];break;default:console.log(n.rock_attr," attr to add")}}},e}();o.Renderer=r},{}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e("./map"),n=e("./map"),i=function(){function e(e){this.prefix="rock-",this.rock=e,this.prefix=e.prefix,console.log("new scanner")}return e.prototype.scan=function(){console.log("scan--------");for(var e=[],t=document.querySelectorAll("*"),o=0;o<t.length;o++){for(var i=t[o],s=[],c=0;c<i.attributes.length;c++){var l=i.attributes[c];if(l.nodeName.search(this.prefix)>-1){var a=l.nodeName.substring(l.nodeName.indexOf("-")+1),u=l.value.split(/\./);if(u.length>1){var h=u[0],f=u[1],d=this.rock.getViewModel(h);d&&s.push(new n.Mapping(a,d,f))}}}s.length>0&&e.push(new r.Map(i,s))}return e},e}();o.Scanner=i},{"./map":2}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=function(){return function(e){this.x=0,this.y=0,this.text=null,this.color="red",this.onmousedown=function(e){"red"==this.color?this.color="blue":this.color="red",console.log("onmousedown")}.bind(this),this.text=e}}();o.TestViewModel=r},{}],6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){this.rock=e,this.pool=t,console.log("new watcher:",this)}return e.prototype.observe=function(e){console.log("going to observe pool:",this.pool);var t=this.rock,o=this;for(var r in this.pool)!function(r){var n=o.pool[r][0];console.log("----observe viewmodel:",n,e);for(var i in n)!function(o){var i=n[o];Object.defineProperty(n,o,{get:function(){return i},set:function(n){i=n,console.log("do something after set a new value on ",r,"-",o),e.call(t)}})}(i)}(r)},e}();o.Watcher=r},{}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e("./lib/Rock"),n=e("./lib/view-model"),i=new r.Rock,s=new n.TestViewModel("I am Moving Every Second, click me!");i.registerViewModel("vm",s),i.init(),s.x=100,setInterval(function(){this.x<50?this.y<50?this.x+=50:this.y-=50:this.y<50?this.y+=50:this.x-=50}.bind(s),1e3)},{"./lib/Rock":1,"./lib/view-model":5}]},{},[7]);
//# sourceMappingURL=bundle.js.map
